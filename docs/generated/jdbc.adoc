
== Tabeller

=== INNGAAENDE_HENDELSE
....
Definerer JSON_FEEDs som leses fra
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|ID|NUMBER|||||PK
|2|SEKVENSNUMMER|NUMBER||||Sekvensnummer for hendelsen|
|3|INPUT_FEED_KODE|VARCHAR2||||Fremmednøkkel til INPUT_FEED|
|4|TYPE|VARCHAR2||||Hendelsetype|
|5|PAYLOAD|CLOB||||Innhold i hendelse|
|6|REQUEST_UUID|VARCHAR2||||id for å identifiser innlesning|
|7|OPPRETTET_AV|VARCHAR2|'VL'|X|||
|8|OPPRETTET_TID|TIMESTAMP(3)|systimestamp|X|||
|9|ENDRET_AV|VARCHAR2||X|||
|10|ENDRET_TID|TIMESTAMP(3)||X|||
|===


=== INPUT_FEED
....
Definerer JSON_FEEDs som leses fra
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|KODE|VARCHAR2||||Primærnøkkel|PK
|2|NAVN|VARCHAR2||||Navn på JSON-feed|
|3|SIST_LEST|TIMESTAMP(3)||X||Tidspunkt for sist det ble lest fra kø|
|4|SIST_FEILET|TIMESTAMP(3)||X|||
|5|FEILET_ANTALL|NUMBER|0|X||Antall ganger henting har feilet etter siste gang det gikk bra.|
|6|NEXT_URL|VARCHAR2||X||Satt hvis det er mer flere sider å lese fra køen|
|7|VENTETID_FERDIGLEST|VARCHAR2||||Hvor lenge det ventes før neste forsøk på å lese når kø er lest helt tom|
|8|VENTETID_LESBAR|VARCHAR2||||Hvor lenge det ventes før neste forsøk på å lese når kø ikke er lest helt tom|
|9|VENTETID_FEILET|VARCHAR2||||Hvor lenge det ventes før neste forsøk på å lese når det var feil i forrige lesing|
|10|OPPRETTET_AV|VARCHAR2|'VL'|X|||
|11|OPPRETTET_TID|TIMESTAMP(3)|systimestamp|X|||
|12|ENDRET_AV|VARCHAR2||X|||
|13|ENDRET_TID|TIMESTAMP(3)||X|||
|===


=== KODELISTE
....
Inneholder lister av koder for alle Kodeverk som benyttes i applikasjonen.  Både offisielle (synkronisert fra sentralt hold i Nav) såvel som interne Kodeverk.  Offisielle koder skiller seg ut ved at nav_offisiell_kode er populert. Følgelig vil gyldig_tom/fom, navn, språk og beskrivelse lastes ned fra Kodeverkklienten eller annen kilde sentralt
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|ID|NUMBER||||Primary Key|PK
|2|KODEVERK|VARCHAR2||||(PK) og FK - kodeverk|
|3|KODE|VARCHAR2||||(PK) Unik kode innenfor kodeverk. Denne koden er alltid brukt internt|
|4|OFFISIELL_KODE|VARCHAR2||X||(Optional) Offisiell kode hos kodeverkeier. Denne kan avvike fra kode der systemet har egne koder. Kan brukes til å veksle inn kode i offisiell kode når det trengs for integrasjon med andre systemer|
|5|NAVN|VARCHAR2||X||Navn på Kodeverket. Offsielt navn synkes dersom Offsiell kode er satt|
|6|BESKRIVELSE|VARCHAR2||X||Beskrivelse av koden|
|7|SPRAK|VARCHAR2|'NB'|X||Språk Kodeverket er definert for, default NB (norsk bokmål). Bruker ISO 639-1 standard men med store bokstaver siden det representert slik i NAVs offisielle Kodeverk|
|8|GYLDIG_FOM|DATE|sysdate|||Dato Kodeverket er gyldig fra og med|
|9|GYLDIG_TOM|DATE|to_date('31.12.9999', 'dd.mm.yyyy')|||Dato Kodeverket er gyldig til og med|
|10|OPPRETTET_AV|VARCHAR2|'VL'||||
|11|OPPRETTET_TID|TIMESTAMP(3)|systimestamp||||
|12|ENDRET_AV|VARCHAR2||X|||
|13|ENDRET_TID|TIMESTAMP(3)||X|||
|14|EKSTRA_DATA|VARCHAR2||X||(Optional) Tilleggsdata brukt av kodeverket.  Format er kodeverk spesifikt - eks. kan være tekst, json, key-value, etc.|
|===


=== KODEVERK
....
Registrerte kodeverk. Representerer grupperinger av koder
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|KODE|VARCHAR2||||PK - definerer kodeverk|PK
|2|KODEVERK_EIER|VARCHAR2|'VL'|||Offisielt kodeverk eier (kode)|
|3|KODEVERK_EIER_REF|VARCHAR2||X||Offisielt kodeverk referanse (url)|
|4|KODEVERK_EIER_VER|VARCHAR2||X||Offisielt kodeverk versjon|
|5|KODEVERK_EIER_NAVN|VARCHAR2||X||Offisielt kodeverk navn|
|6|KODEVERK_SYNK_NYE|CHAR|'J'|||Om nye koder fra kodeverkeier skal legges til ved oppdatering.|
|7|KODEVERK_SYNK_EKSISTERENDE|CHAR|'J'|||Om eksisterende koder fra kodeverkeier skal endres ved oppdatering.|
|8|NAVN|VARCHAR2||||Navn på kodeverk|
|9|BESKRIVELSE|VARCHAR2||X||Beskrivelse av kodeverk|
|10|OPPRETTET_AV|VARCHAR2|'VL'||||
|11|OPPRETTET_TID|TIMESTAMP(3)|systimestamp||||
|12|ENDRET_AV|VARCHAR2||X|||
|13|ENDRET_TID|TIMESTAMP(3)||X|||
|14|SAMMENSATT|VARCHAR2|'N'|X||Skiller mellom sammensatt kodeverk og enkel kodeliste|
|===


=== KONFIG_VERDI
....
Angir konfigurerbare verdier med kode, eventuelt tilhørende gruppe.
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|ID|NUMBER||||Primary Key|PK
|2|KONFIG_KODE|VARCHAR2||||Angir kode som identifiserer en konfigurerbar verdi.|
|3|KONFIG_GRUPPE|VARCHAR2||||Angir gruppe en konfigurerbar verdi kode tilhører (hvis noen - kan også spesifiseres som INGEN).|
|4|KONFIG_VERDI|VARCHAR2||X||Angir verdi|
|5|GYLDIG_FOM|DATE|sysdate|||Gydlig fra-og-med dato|
|6|GYLDIG_TOM|DATE|to_date('31.12.9999', 'dd.mm.yyyy')|||Gydlig til-og-med dato|
|7|OPPRETTET_AV|VARCHAR2|'VL'||||
|8|OPPRETTET_TID|TIMESTAMP(3)|systimestamp||||
|9|ENDRET_AV|VARCHAR2||X|||
|10|ENDRET_TID|TIMESTAMP(3)||X|||
|11|KL_KONFIG_VERDI_GRUPPE|VARCHAR2|'KONFIG_VERDI_GRUPPE'||||
|===


=== KONFIG_VERDI_KODE
....
Angir unik kode for en konfigurerbar verdi for validering og utlisting av tilgjengelige koder.
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|KODE|VARCHAR2||||Primary Key|PK
|2|KONFIG_GRUPPE|VARCHAR2|'INGEN'|||Angir gruppe en konfigurerbar verdi kode tilhører (hvis noen - kan også spesifiseres som INGEN).|PK
|3|NAVN|VARCHAR2||||Angir et visningsnavn|
|4|KONFIG_TYPE|VARCHAR2||||Type angivelse for koden|
|5|BESKRIVELSE|VARCHAR2||X||Beskrivelse av formÃ¥let den konfigurerbare verdien|
|6|OPPRETTET_AV|VARCHAR2|'VL'||||
|7|OPPRETTET_TID|TIMESTAMP(3)|systimestamp||||
|8|ENDRET_AV|VARCHAR2||X|||
|9|ENDRET_TID|TIMESTAMP(3)||X|||
|10|KL_KONFIG_VERDI_GRUPPE|VARCHAR2|'KONFIG_VERDI_GRUPPE'|||Referanse til KODEVERK-kolonnen i KODELISTE-tabellen|
|11|KL_KONFIG_VERDI_TYPE|VARCHAR2|'KONFIG_VERDI_TYPE'|||Referanse til KODEVERK-kolonnen i KODELISTE-tabellen|
|===


=== PROSESS_TASK
....
<MISSING DOCUMENTATION>
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|ID|NUMBER|||||PK
|2|TASK_TYPE|VARCHAR2|||||
|3|PRIORITET|NUMBER|0||||
|4|STATUS|VARCHAR2|'KLAR'||||
|5|TASK_PARAMETERE|VARCHAR2||X|||
|6|TASK_PAYLOAD|CLOB||X|||
|7|TASK_GRUPPE|VARCHAR2||X|||
|8|TASK_SEKVENS|VARCHAR2|'1'||||
|9|NESTE_KJOERING_ETTER|TIMESTAMP(0)|current_timestamp|X|||
|10|FEILEDE_FORSOEK|NUMBER|0|X|||
|11|SISTE_KJOERING_TS|TIMESTAMP(6)||X|||
|12|SISTE_KJOERING_FEIL_KODE|VARCHAR2||X|||
|13|SISTE_KJOERING_FEIL_TEKST|CLOB||X|||
|14|SISTE_KJOERING_SERVER|VARCHAR2||X|||
|15|VERSJON|NUMBER|0||||
|===


=== PROSESS_TASK_FEILHAND
....
Kodetabell for feilhåndterings-metoder. For eksempel antall ganger å prøve på nytt og til hvilke tidspunkt
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|KODE|VARCHAR2||||Kodeverk Primary Key|PK
|2|NAVN|VARCHAR2||||Lesbart navn på type feilhåndtering brukt i prosesstask|
|3|BESKRIVELSE|VARCHAR2||X||Utdypende beskrivelse av koden|
|4|OPPRETTET_AV|VARCHAR2|'VL'||||
|5|OPPRETTET_TID|TIMESTAMP(3)|systimestamp||||
|6|ENDRET_AV|VARCHAR2||X|||
|7|ENDRET_TID|TIMESTAMP(3)||X|||
|8|INPUT_VARIABEL1|NUMBER||X|||
|9|INPUT_VARIABEL2|NUMBER||X|||
|===


=== PROSESS_TASK_TYPE
....
Kodetabell for typer prosesser med beskrivelse og informasjon om hvilken feilhåndteringen som skal benyttes
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|KODE|VARCHAR2||||Kodeverk Primary Key|PK
|2|NAVN|VARCHAR2||X||Lesbart navn på prosesstasktype|
|3|FEIL_MAKS_FORSOEK|NUMBER|1|||MISSING COLUMN COMMENT|
|4|FEIL_SEK_MELLOM_FORSOEK|NUMBER|30|||MISSING COLUMN COMMENT|
|5|FEILHANDTERING_ALGORITME|VARCHAR2|'DEFAULT'|X||FK: PROSESS_TASK_FEILHAND|
|6|BESKRIVELSE|VARCHAR2||X||Utdypende beskrivelse av koden|
|7|OPPRETTET_AV|VARCHAR2|'VL'||||
|8|OPPRETTET_TID|TIMESTAMP(3)|systimestamp||||
|9|ENDRET_AV|VARCHAR2||X|||
|10|ENDRET_TID|TIMESTAMP(3)||X|||
|===


=== SCHEMA_VERSION
....
<MISSING DOCUMENTATION>
....


[options="header", cols="5h,10h,5,10,5,15,30,20"]
|===
|#|Navn|Type|Default|Nullable|Constraint|Comment|Key
|1|INSTALLED_RANK|NUMBER|||||PK
|2|VERSION|VARCHAR2||X|||
|3|DESCRIPTION|VARCHAR2|||||
|4|TYPE|VARCHAR2|||||
|5|SCRIPT|VARCHAR2|||||
|6|CHECKSUM|NUMBER||X|||
|7|INSTALLED_BY|VARCHAR2|||||
|8|INSTALLED_ON|TIMESTAMP(6)|CURRENT_TIMESTAMP||||
|9|EXECUTION_TIME|NUMBER|||||
|10|SUCCESS|NUMBER|||||
|===


== Kodeverk

=== INPUT_FEED
....
Definerer JSON_FEEDs som leses fra
....


[options="header", cols="0,0,0,0,0,0,0,0,0h"]
|===
|NAVN|SIST_LEST|SIST_FEILET|FEILET_ANTALL|NEXT_URL|VENTETID_FERDIGLEST|VENTETID_LESBAR|VENTETID_FEILET|KODE
|JSON feed fra TPS|||0||PT1H|PT1M|PT1M|JF_TPS
|JSON feed fra Infotrygd|||0||PT1H|PT1M|PT1M|JF_INFOTRYGD
|===


=== PROSESS_TASK_FEILHAND
....
Kodetabell for feilhåndterings-metoder. For eksempel antall ganger å prøve på nytt og til hvilke tidspunkt
....


[options="header", cols="0,0,0,0,0h"]
|===
|NAVN|BESKRIVELSE|INPUT_VARIABEL1|INPUT_VARIABEL2|KODE
|Eksponentiell back-off med tak||||DEFAULT
|===


=== PROSESS_TASK_TYPE
....
Kodetabell for typer prosesser med beskrivelse og informasjon om hvilken feilhåndteringen som skal benyttes
....


[options="header", cols="0,0,0,0,0,0h"]
|===
|NAVN|FEIL_MAKS_FORSOEK|FEIL_SEK_MELLOM_FORSOEK|FEILHANDTERING_ALGORITME|BESKRIVELSE|KODE
|Utfører grovsortering av hendelser|3|30|DEFAULT||hendelser.grovsorter
|Sender hendelse til vedtaksløsning|3|30|DEFAULT||hendelser.sendHendelse
|===



